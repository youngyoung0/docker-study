# 컨테이너개발

### 이미지 빌드의 개요

도커 이미지 만드는 명령어

docker build [옵션] 경로 | URL | - 

![KakaoTalk_Photo_2022-03-13-17-24-28.jpeg](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%80%20343fc/KakaoTalk_Photo_2022-03-13-17-24-28.jpeg)

- 베이스 이미지 선택(이미지 만들때 바탕이 되는 이미지)
    
    리눅스의 공유 라이브러리, 동적 링크나 로드에 필요한 기초적인 파일들이 포함되며, 이를 기반으로 사용자의 이미지를 만들게 된다.
    
- 소프트웨어 패키지 설치
    
    애플리케이션 실행에 필요한 소프트웨어 패키지 설치한다.
    
    주로 운영체제나 프로그래밍 언어의 패키지 매니저를 사용해서 설치하게 된다.
    
- 애플리케이션 소스 코드
    
    깃헙 혹은 로컬에 있는 소스 코드를 이미지에 복사한다.
    
- Dockerfile
    
    이미지를 빌드하는 스크립트가 기재된 파일
    
    - 베이스 이미지의 리포지터리
    - 설치할 피키지
    - 애플리케이션 코드와 설정 파일
    - 컨테이너 기동시 실행될 명령어

### 빌드 실행 순서

- 디렉터리를 준비하여 이미지에 포함시킬 파일들을 모은다.
- Dockerfile을 작성한다.
    
    ```bash
    FROM  alpine:latest ## 베이스 이미지 지정
    RUN   apk update && apk add figlet ## 리눅스 패키지 및 추가 모듈 설치
    ADD   ./message /message ## 컨테이너의 파일 시스템에 파일을 추가
    CMD   cat /message | figlet ## 컨테이너 기동시 실행할 커맨드를 지정한다.
    ```
    
- 컨테이너에서 실행할 애플리케이션 코드를 작성하고 유닛 테스트를 실행한다.
    
    ```bash
    echo "Hello World" > message
    cat message
    ```
    
- 이미지를 빌드한다.
    
    ‘docker build —tag 리포지터리명[:태그] 경로'를 실행하면 Dockerfile에 따라 이미지를 빌드한다.
    
    | 옵션 | 설명 |
    | --- | --- |
    | --tag | 빌드된 이미지의 이름과 태그를 지정한다. |
    | . | Dockerfile의 경로를 지정하기 위한것으로 현재 디렉터리에 Dockerfile를 의미하는것이다. |
    
    ```bash
    docker build --tage hello:1.0 .
    ```
    
    ![스크린샷 2022-03-13 오후 6.52.12.png](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%80%20343fc/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-03-13_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6.52.12.png)
    
- 컨테이너를 실행하고 동작을 확인한다.
    
    ![스크린샷 2022-03-13 오후 6.52.54.png](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%80%20343fc/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-03-13_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6.52.54.png)
    

### Dockerfile 작성법

![KakaoTalk_Photo_2022-03-13-18-58-12.jpeg](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%E1%84%80%20343fc/KakaoTalk_Photo_2022-03-13-18-58-12.jpeg)

### Dockerfile→ 운영상의 장점

- 프로젝트에 새롭게 참가한 개발자가 개발 및 실행환경에 대해 학습해야 할 시간과 노력을 줄여준다.
- 소프트웨어의 의존 관계를 컨테이너에 담아서 실행환경 사이의 이동을 쉽게해준다.
- 서버 관리나 시스템 관리의 부담을 줄여준다.
- 개발 환경과 운영환경의 차이를 줄여서 지속적 개발과 릴리즈를 쉽게 해준다.
- 같은 이미지를 사용하는 컨테이너 수를 늘림으로써 쉽게 처리 능력을 높일수 있다.

---

### 정리

- 이미지를 빌드하려면 먼저 디렉터리를 만들고 이미지에 포함시킬 파일들을 모아야 한다.
- 그 디렉터리에 Dockerfile을 만들고 ‘docker build’ 명령어로 이미지를 빌드한다.
- Dockerfile에서는 FROM으로 베이스 이미지를 지정
RUN으로 스크립트를 실행
ADD로 컨테이너 안에 파일이나 디렉터리를 추가
CMD로 컨테이너 기동시 실행할 명령어를 지정
- 빌드가 무사히 완료되면 ‘--tag’옵션을 사용해 지정한 이름으로 로컬 리포지터리에 이미지가 저장된다.