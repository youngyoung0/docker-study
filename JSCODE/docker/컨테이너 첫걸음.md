# 컨테이너 첫걸음

### 도커 설치

- homebrew에서 Docker 검색
    
    ```bash
    $ brew search docker
    ```
    
    ![스크린샷 2022-03-09 오후 10.50.39.png](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%20%2085fd6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-03-09_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_10.50.39.png)
    
    ‘brew search <명령여>’ → 프로그램이 있는지 검색
    

- docker 설치
    
    ```bash
    $ brew install --cask docker
    ```
    

- 설치 이후에 설치가 잘 되었는지 확인하기 위해서 hello-word 컨테이너 실행을 통해서 토커가 정상적으로 설치되었고, 잘작동하는지 확인
    
    ```bash
    $ docker run hello-world
    ```
    

동작 원리

1. 터미널에서 ‘docker run hello-world’를 실행하면 도커 데몬에 접속한다.
2. 도커 허브의 리포지터리 [https://hub.docker.com/_/hello-world](https://hub.docker.com/_/hello-world)에서 컨테이너를 위한 이미지를 로컬에 다운로드합니다.
3. 도커 엔진이 이미지로 부터 컨테이너를 생성합니다. 컨테이너상의 프로세스가 메시지를 표준 출력에 쓰기 시작합니다.
4. 도커 엔진은 컨테이너의 표준 출력을 도커 커맨드에 보내고 터미널에 표시한다.

---

➢ ‘이미지' : 운영체제와 소프트웨어를 담고 있는 컨테이너 실행 이전의 상태다. 각 이미지는 리포지터리:태그로 식별된다.

➢ ‘도커의 리포지터리' : 이미지 보관소를 뜻한다. 리포지 터리의 이름에 버전 등을 의미하는 태그를 붙여서 각각의 이미지를 구별하여 보관한다.

➢ ‘레지스트리' 리포지터리의 집합체로서 리포지터리를 제공하는 서버를 말한다.

### 컨테이너의 생명 주기와 도커 커맨드

![KakaoTalk_Photo_2022-03-13-14-43-38.jpeg](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%20%2085fd6/KakaoTalk_Photo_2022-03-13-14-43-38.jpeg)

1. docker pull (이미지 다운로드)
    
    ‘docker pull 리포지터리명[:태그]를 실행하면 원격의 리포지터리로 부터 이미지를 다운로드(pull) 한다.
    
    ![스크린샷 2022-03-13 오후 2.49.34.png](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%20%2085fd6/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2022-03-13_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.49.34.png)
    
2. docker run (컨테이너 실행)
    
    ‘docker run [옵션] 리포지터리명:태그 [커맨드] [인자]’는 지정한 이미지를 모형으로 컨테이너를 가동한다.
    
    | 옵션 | 설명 |
    | --- | --- |
    | -i | 키보드 입력을 컨테이너의 표준 입력에 연결하여 키보드 입력을 컨테이너의 셸 등에 보낸다. |
    | -t | 터미널을 통해 대화형 조작이 가능하게 한다. |
    | -d | 백그라운드로 컨테이너를 돌려 터미널과 연결하지 않는다. |
    | --name | 컨테이너에 이름을 설정한다. 시스템에서 유일한 이름이어야 하며, 옵션을 생략하면 자동으로 만들어진 이름이 부여된다. |
    | --rm | 컨테이너가 종료하면 종료 상태의 컨테이너를 자동으로 삭제한다. |

1. docker ps (컨테이너의 상태 출력)
    
    ‘docker ps’ :실행중인 컨테이너 목록을 출력
    
    ‘docker ps -a’ 정지 상태인 컨테이너도 출력된다.
    

1. docker logs(로그 출력)
    
    정지 상태인 컨테이너는 삭제될 때까지 남아 있으며, 실행중 발생한 표준 출력과 표준 에러 출력을 가지고 있다.
    
    ‘docker logs [컨테이너 ID]’ → 삭제되었을까지 로그를 확인할 수 있다.
    
    ‘docker logs -f [컨테이너 ID]’ → 실행중인 상태에서 실시간으로 발생하는 로그를 확인할 수 있다.
    
2. docker stop, docker kill (컨테이너 정지)
    
    실행중인 컨테이너를 정지시킨다.
    
    - 컨테이너 PID=1인 프로세스가 종료한다. → 이미지를 별다른 커맨드 없이 실행하고, 실행하자마자 바로 종료
    - ‘docker stop 컨테이너 ID | 컨테이너명'을 실행한다.
    - ‘docker kill 컨테이너 ID | 컨테이너명'을 실행한다.
    
    ---
    
    docker stop / docker kill의 차이점은? 
    
    docker stop 천천히 종료
    
    docker kill 강제 종료
    
3. docker start ( 컨테이너 재기동)
    
    ‘docker start 컨테이너명’ : 재기동 할 수 있다.
    
    ‘docker start -i 컨테이너명' : 컨테이너가 터미널의 입력을 받아 표준 출력과 표준 에러를 터미널에 표시해준다.
    
4. docker commit ( 컨테이너의 변경 사항을 리포지터리에 저장)
    
    컨테이너를 가동하고나서 필요한 패키지를 다운로드 받거나 업데이트 하고나서 
    
    ‘docker commit 컨테이너 ID | 컨테이너명 리포지터리명 [:태그]’를 실행하면 현재 컨테이너의 상태를 이미지로 만들어 리포지터리에 보관 할 수 있다.
    
5. docker push (이미지를 원격 리포지터리에 보관)
    
    8-1. 도커 허브 리포지터를 사용
    
    - 도커 허브에 가입하여 도커 ID를 취득, 하나의 계정을 만들면 여러 개의 리포지터리를 소유
    - ‘docker login’ → 도커 허브에 가입한 계정으로 로그인
    - ‘docker tag’로 로컬의 이미지에 태그를 부여
    - ‘docker push’를 사용하여 이미지를 원격 리포지터리에 업로드
    - 도커 허브에 접속하여 등록된 것을 확인하고 필요에 맞게 설명을 기재한다.
    
6. docker rm (종료한 컨테이너 제거)
    
    ‘docker rm 컨테이너 ID | 컨테이너명'를 실행하면 컨테이너가 삭제된다.
    
    컨테이너가 삭제되면 로고도 지워지고 더이상 재기동 할수가 없게된다.
    
7. docker rmi (필요 없어진 이미지를 로컬 리포지터리에서 삭제)
    
    ‘docker rmi 이미지 ID’ 필요 없어진 이미지를 로컬 리포지터리에서 삭제하고자 할때
    

---

### 정리

- 도커 커맨드는 백그라운드에서 돌고 있는 도커 엔진에 명령을 주어 컨테이너를 실행
- 컨테이너를 실행하기 위해서는 리눅스 커널이 필요하기 때문에 macOS나 Window OS에서는 가상 머신의 리눅스에서 컨테이너를 실행한다.
- 도커 엔진은 docker 커맨드의 요청을 받아서 원격 리포지터리에서 이미지를 다운로드하고, 컨테이너를 생성하여 실행하고, 애플리케이션의 입출력을 터미널과 연결하는 역할 등을 수행한다.
- hello-world 이미지는 도커 허브에 등록되어 있다. 도커 허브에 등록된 이미지는 누구나 무료로 다운로드 할수 있다.
- 컨테이너는 도커 커맨드에 따라 이미지, 실행, 정지의 세가지 상태를 전의한다.
- 참조 도커 커맨드
    
    [https://docs.docker.com/engine/reference/commandline/docker/](https://docs.docker.com/engine/reference/commandline/docker/)
    
    컨테이너 계열 : [https://docs.docker.com/engine/reference/commandline/container/](https://docs.docker.com/engine/reference/commandline/container/)
    
    이미지 계열 : [https://docs.docker.com/engine/reference/commandline/image/](https://docs.docker.com/engine/reference/commandline/image/)