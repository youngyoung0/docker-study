# 컨테이너 다루기

### 대화형 모드로 컨테이너 기동 및 정지

‘docker run -it 리포지터리명:[태그] 셸’ → 대화형 모드로 컨테이너 기동

| 옵션 | 설명 |
| --- | --- |
| -i | 키보드의 입력을 표준 입력을 셸에 전다 |
| -t | 유사 터미널 디바이스와 셸을 연결 |

‘exit’ → 대화형 모드로 컨테이너 정지

### 컨테이너 조작 및 이미지 작성

- 컨테이너에 패키지 설치하기(우분투)
    
    ```bash
    ## docker run -it --name test
    
    apt-get update && apt-get install -y inputils-ping net-tools iproute2 dnsutils curl
    ```
    
- 컨테이너에 패키지 설치하기 (Centos 7)
    
    ```bash
    yum update -y && yum install -y iputils net-tools iproute bind-utils
    ```
    
- 컨테이너를 이미지로 만들어서 리포지터리에 보관
    
    ```bash
    docker commit centos my-centos:0.1
    ```
    

### 여러 터미널에서 조작하기

아래 명령어를 활용하여서 여러 터미널에서 터미널이 접속하여서 작업이 가능하다. 따로 인증과정이없어서 가상 서버보다 더 편리하게 사용할 수 있다.

- 대화형 컨테이너로 셸 기동
    
    docker run -it  --name 컨테이너이름 centos:7 bash
    
- 실행중인 컨테이너에 접속
    
    docker exec -it 컨테이너이름 | 컨테이너 ID bash
    
- 로그인을 관리하지 않는 컨테이너
    
    ![KakaoTalk_Photo_2022-03-13-17-06-13.jpeg](%E1%84%8F%E1%85%A5%E1%86%AB%E1%84%90%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%82%E1%85%A5%20%20481b2/KakaoTalk_Photo_2022-03-13-17-06-13.jpeg)
    
    - ‘w커맨드' : 동시에 로그인한 다른 유저의 정보를 얻을수 있다.
        
        하지만 아무도 출력되지 않은 이유는 컨테이너는 로그인을 통한 유저 인증 기능도 없고, 유저 자체를 관리하지 않기때문이다.
        
    - ‘ps’ : 유사 터미널 ‘pts/1’에 연결되어 있다.
    - ‘tty’ : ‘dev.pts/1’이 표시된다. → docker run -t 의해 서버에 로그인 하는것과 비슷한 유사 터미널이 셸에 접속했기 때문이다.
    해당 커널
    - ‘ps ax’ : PID 1은 터미널 1에서 ‘docker run’으로 기동한 bash이고, 유사 터미널 pts/0과 연결되어 있다.
    

---

### 정리

- 컨테이너를 사용하면 마시 가상 서버인 것처럼 독립적으로 사용할 수 있다.
- 컨테이너를 여러개 기동하면 분리된 가상 서버인 것처럼 독립적으로 사용
- 컨테이너는 IP주소를 가지며 호스트의 다른 컨테이너들과 통신할수 있다.
- ‘docker commit’명령어를 통해서 컨테이너를 이미지로 만들어 로컬 리포지터리에 보관하고 재사용할수 있다.
- 리눅스는 원래 멀티 유저용 운영체지만 컨테이너는 유저 인증 기능을 제거하여 단일 유저 시스템처럼 사용한다.
- 의도적으로 포트를 열지 않는 이상 호스트의 외부에서 컨테이너에 접속할수 없다.
- 컨테이너는 호스트의 커널을 공유하는 리눅스 프로세스이다.